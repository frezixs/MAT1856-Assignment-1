# estimate yield to maturity every year at today 
#---------------------------------------------------------------------
# 1/2
yf1221 = yearFraction("2020-01-02","2021-01-02")

yf1222 = yearFraction("2020-01-02","2022-01-02")

yf1223 = yearFraction("2020-01-02","2023-01-02")

yf1224 = yearFraction("2020-01-02","2024-01-02")

yf1225 = yearFraction("2020-01-02","2025-01-02")

yf12_202091 = yearFraction("2020-01-02","2020-09-01")
yf12_202131 = yearFraction("2020-01-02","2021-03-01")

yf12_202191 = yearFraction("2020-01-02","2021-09-01")
yf12_202231 = yearFraction("2020-01-02","2022-03-01")

yf12_202291 = yearFraction("2020-01-02","2022-09-01")
yf12_202331 = yearFraction("2020-01-02","2023-03-01")

yf12_202391 = yearFraction("2020-01-02","2023-09-01")
yf12_202431 = yearFraction("2020-01-02","2024-03-01")

yf12_202491 = yearFraction("2020-01-02","2024-09-01")
yf12_202531 = yearFraction("2020-01-02","2025-03-01")

y1221 = y12_202091+((y12_202131-y12_202091)/(yf12_202131-yf12_202091))*(yf1221-yf12_202091)

y1222 = y12_202191+((y12_202231-y12_202191)/(yf12_202231-yf12_202191))*(yf1222-yf12_202191)

y1223 = y12_202291+((y12_202331-y12_202291)/(yf12_202331-yf12_202291))*(yf1223-yf12_202291)

y1224 = y12_202391+((y12_202431-y12_202391)/(yf12_202431-yf12_202391))*(yf1224-yf12_202391)

y1225 = y12_202491+((y12_202531-y12_202491)/(yf12_202531-yf12_202491))*(yf1225-yf12_202491)

y1221
y1222
y1223
y1224
y1225

#---------------------------------------------------------------------
# 1/3
yf1321 = yearFraction("2020-01-03","2021-01-03")

yf1322 = yearFraction("2020-01-03","2022-01-03")

yf1323 = yearFraction("2020-01-03","2023-01-03")

yf1324 = yearFraction("2020-01-03","2024-01-03")

yf1325 = yearFraction("2020-01-03","2025-01-03")

yf13_202091 = yearFraction("2020-01-03","2020-09-01")
yf13_202131 = yearFraction("2020-01-03","2021-03-01")

yf13_202191 = yearFraction("2020-01-03","2021-09-01")
yf13_202231 = yearFraction("2020-01-03","2022-03-01")

yf13_202291 = yearFraction("2020-01-03","2022-09-01")
yf13_202331 = yearFraction("2020-01-03","2023-03-01")

yf13_202391 = yearFraction("2020-01-03","2023-09-01")
yf13_202431 = yearFraction("2020-01-03","2024-03-01")

yf13_202491 = yearFraction("2020-01-03","2024-09-01")
yf13_202531 = yearFraction("2020-01-03","2025-03-01")

y1321 = y13_202091+((y13_202131-y13_202091)/(yf13_202131-yf13_202091))*(yf1321-yf13_202091)
y1322 = y13_202191+((y13_202231-y13_202191)/(yf13_202231-yf13_202191))*(yf1322-yf13_202191)
y1323 = y13_202291+((y13_202331-y13_202291)/(yf13_202331-yf13_202291))*(yf1323-yf13_202291)
y1324 = y13_202391+((y13_202431-y13_202391)/(yf13_202431-yf13_202391))*(yf1324-yf13_202391)
y1325 = y13_202491+((y13_202531-y13_202491)/(yf13_202531-yf13_202491))*(yf1325-yf13_202491)



#---------------------------------------------------------------------
# 1/6
yf1621 = yearFraction("2020-01-06","2021-01-06")
yf1622 = yearFraction("2020-01-06","2022-01-06")
yf1623 = yearFraction("2020-01-06","2023-01-06")
yf1624 = yearFraction("2020-01-06","2024-01-06")
yf1625 = yearFraction("2020-01-06","2025-01-06")

yf16_202091 = yearFraction("2020-01-06","2020-09-01")
yf16_202131 = yearFraction("2020-01-06","2021-03-01")
yf16_202191 = yearFraction("2020-01-06","2021-09-01")
yf16_202231 = yearFraction("2020-01-06","2022-03-01")
yf16_202291 = yearFraction("2020-01-06","2022-09-01")
yf16_202331 = yearFraction("2020-01-06","2023-03-01")
yf16_202391 = yearFraction("2020-01-06","2023-09-01")
yf16_202431 = yearFraction("2020-01-06","2024-03-01")
yf16_202491 = yearFraction("2020-01-06","2024-09-01")
yf16_202531 = yearFraction("2020-01-06","2025-03-01")

y1621 = y16_202091+((y16_202131-y16_202091)/(yf16_202131-yf16_202091))*(yf1621-yf16_202091)
y1622 = y16_202191+((y16_202231-y16_202191)/(yf16_202231-yf16_202191))*(yf1622-yf16_202191)
y1623 = y16_202291+((y16_202331-y16_202291)/(yf16_202331-yf16_202291))*(yf1623-yf16_202291)
y1624 = y16_202391+((y16_202431-y16_202391)/(yf16_202431-yf16_202391))*(yf1624-yf16_202391)
y1625 = y16_202491+((y16_202531-y16_202491)/(yf16_202531-yf16_202491))*(yf1625-yf16_202491)



#---------------------------------------------------------------------
# 1/7
yf1721 = yearFraction("2020-01-07","2021-01-07")
yf1722 = yearFraction("2020-01-07","2022-01-07")
yf1723 = yearFraction("2020-01-07","2023-01-07")
yf1724 = yearFraction("2020-01-07","2024-01-07")
yf1725 = yearFraction("2020-01-07","2025-01-07")

yf17_202091 = yearFraction("2020-01-07","2020-09-01")
yf17_202131 = yearFraction("2020-01-07","2021-03-01")
yf17_202191 = yearFraction("2020-01-07","2021-09-01")
yf17_202231 = yearFraction("2020-01-07","2022-03-01")
yf17_202291 = yearFraction("2020-01-07","2022-09-01")
yf17_202331 = yearFraction("2020-01-07","2023-03-01")
yf17_202391 = yearFraction("2020-01-07","2023-09-01")
yf17_202431 = yearFraction("2020-01-07","2024-03-01")
yf17_202491 = yearFraction("2020-01-07","2024-09-01")
yf17_202531 = yearFraction("2020-01-07","2025-03-01")

y1721 = y17_202091+((y17_202131-y17_202091)/(yf17_202131-yf17_202091))*(yf1721-yf17_202091)
y1722 = y17_202191+((y17_202231-y17_202191)/(yf17_202231-yf17_202191))*(yf1722-yf17_202191)
y1723 = y17_202291+((y17_202331-y17_202291)/(yf17_202331-yf17_202291))*(yf1723-yf17_202291)
y1724 = y17_202391+((y17_202431-y17_202391)/(yf17_202431-yf17_202391))*(yf1724-yf17_202391)
y1725 = y17_202491+((y17_202531-y17_202491)/(yf17_202531-yf17_202491))*(yf1725-yf17_202491)



#---------------------------------------------------------------------
# 1/8
yf1821 = yearFraction("2020-01-08","2021-01-08")
yf1822 = yearFraction("2020-01-08","2022-01-08")
yf1823 = yearFraction("2020-01-08","2023-01-08")
yf1824 = yearFraction("2020-01-08","2024-01-08")
yf1825 = yearFraction("2020-01-08","2025-01-08")

yf18_202091 = yearFraction("2020-01-08","2020-09-01")
yf18_202131 = yearFraction("2020-01-08","2021-03-01")
yf18_202191 = yearFraction("2020-01-08","2021-09-01")
yf18_202231 = yearFraction("2020-01-08","2022-03-01")
yf18_202291 = yearFraction("2020-01-08","2022-09-01")
yf18_202331 = yearFraction("2020-01-08","2023-03-01")
yf18_202391 = yearFraction("2020-01-08","2023-09-01")
yf18_202431 = yearFraction("2020-01-08","2024-03-01")
yf18_202491 = yearFraction("2020-01-08","2024-09-01")
yf18_202531 = yearFraction("2020-01-08","2025-03-01")

y1821 = y18_202091+((y18_202131-y18_202091)/(yf18_202131-yf18_202091))*(yf1821-yf18_202091)
y1822 = y18_202191+((y18_202231-y18_202191)/(yf18_202231-yf18_202191))*(yf1822-yf18_202191)
y1823 = y18_202291+((y18_202331-y18_202291)/(yf18_202331-yf18_202291))*(yf1823-yf18_202291)
y1824 = y18_202391+((y18_202431-y18_202391)/(yf18_202431-yf18_202391))*(yf1824-yf18_202391)
y1825 = y18_202491+((y18_202531-y18_202491)/(yf18_202531-yf18_202491))*(yf1825-yf18_202491)



#---------------------------------------------------------------------
# 1/9
yf1921 = yearFraction("2020-01-09","2021-01-09")
yf1922 = yearFraction("2020-01-09","2022-01-09")
yf1923 = yearFraction("2020-01-09","2023-01-09")
yf1924 = yearFraction("2020-01-09","2024-01-09")
yf1925 = yearFraction("2020-01-09","2025-01-09")

yf19_202091 = yearFraction("2020-01-09","2020-09-01")
yf19_202131 = yearFraction("2020-01-09","2021-03-01")
yf19_202191 = yearFraction("2020-01-09","2021-09-01")
yf19_202231 = yearFraction("2020-01-09","2022-03-01")
yf19_202291 = yearFraction("2020-01-09","2022-09-01")
yf19_202331 = yearFraction("2020-01-09","2023-03-01")
yf19_202391 = yearFraction("2020-01-09","2023-09-01")
yf19_202431 = yearFraction("2020-01-09","2024-03-01")
yf19_202491 = yearFraction("2020-01-09","2024-09-01")
yf19_202531 = yearFraction("2020-01-09","2025-03-01")

y1921 = y19_202091+((y19_202131-y19_202091)/(yf19_202131-yf19_202091))*(yf1921-yf19_202091)
y1922 = y19_202191+((y19_202231-y19_202191)/(yf19_202231-yf19_202191))*(yf1922-yf19_202191)
y1923 = y19_202291+((y19_202331-y19_202291)/(yf19_202331-yf19_202291))*(yf1923-yf19_202291)
y1924 = y19_202391+((y19_202431-y19_202391)/(yf19_202431-yf19_202391))*(yf1924-yf19_202391)
y1925 = y19_202491+((y19_202531-y19_202491)/(yf19_202531-yf19_202491))*(yf1925-yf19_202491)

#---------------------------------------------------------------------
# 1/10
yf11021 = yearFraction("2020-01-10","2021-01-10")
yf11022 = yearFraction("2020-01-10","2022-01-10")
yf11023 = yearFraction("2020-01-10","2023-01-10")
yf11024 = yearFraction("2020-01-10","2024-01-10")
yf11025 = yearFraction("2020-01-10","2025-01-10")

yf110_202091 = yearFraction("2020-01-10","2020-09-01")
yf110_202131 = yearFraction("2020-01-10","2021-03-01")
yf110_202191 = yearFraction("2020-01-10","2021-09-01")
yf110_202231 = yearFraction("2020-01-10","2022-03-01")
yf110_202291 = yearFraction("2020-01-10","2022-09-01")
yf110_202331 = yearFraction("2020-01-10","2023-03-01")
yf110_202391 = yearFraction("2020-01-10","2023-09-01")
yf110_202431 = yearFraction("2020-01-10","2024-03-01")
yf110_202491 = yearFraction("2020-01-10","2024-09-01")
yf110_202531 = yearFraction("2020-01-10","2025-03-01")

y11021 = y110_202091+((y110_202131-y110_202091)/(yf110_202131-yf110_202091))*(yf11021-yf110_202091)
y11022 = y110_202191+((y110_202231-y110_202191)/(yf110_202231-yf110_202191))*(yf11022-yf110_202191)
y11023 = y110_202291+((y110_202331-y110_202291)/(yf110_202331-yf110_202291))*(yf11023-yf110_202291)
y11024 = y110_202391+((y110_202431-y110_202391)/(yf110_202431-yf110_202391))*(yf11024-yf110_202391)
y11025 = y110_202491+((y110_202531-y110_202491)/(yf110_202531-yf110_202491))*(yf11025-yf110_202491)


#---------------------------------------------------------------------
# 1/13
yf11321 = yearFraction("2020-01-13","2021-01-13")
yf11322 = yearFraction("2020-01-13","2022-01-13")
yf11323 = yearFraction("2020-01-13","2023-01-13")
yf11324 = yearFraction("2020-01-13","2024-01-13")
yf11325 = yearFraction("2020-01-13","2025-01-13")

yf113_202091 = yearFraction("2020-01-13","2020-09-01")
yf113_202131 = yearFraction("2020-01-13","2021-03-01")
yf113_202191 = yearFraction("2020-01-13","2021-09-01")
yf113_202231 = yearFraction("2020-01-13","2022-03-01")
yf113_202291 = yearFraction("2020-01-13","2022-09-01")
yf113_202331 = yearFraction("2020-01-13","2023-03-01")
yf113_202391 = yearFraction("2020-01-13","2023-09-01")
yf113_202431 = yearFraction("2020-01-13","2024-03-01")
yf113_202491 = yearFraction("2020-01-13","2024-09-01")
yf113_202531 = yearFraction("2020-01-13","2025-03-01")

y11321 = y113_202091+((y113_202131-y113_202091)/(yf113_202131-yf113_202091))*(yf11321-yf113_202091)
y11322 = y113_202191+((y113_202231-y113_202191)/(yf113_202231-yf113_202191))*(yf11322-yf113_202191)
y11323 = y113_202291+((y113_202331-y113_202291)/(yf113_202331-yf113_202291))*(yf11323-yf113_202291)
y11324 = y113_202391+((y113_202431-y113_202391)/(yf113_202431-yf113_202391))*(yf11324-yf113_202391)
y11325 = y113_202491+((y113_202531-y113_202491)/(yf113_202531-yf113_202491))*(yf11325-yf113_202491)

#---------------------------------------------------------------------
# 1/14
yf11421 = yearFraction("2020-01-14","2021-01-14")
yf11422 = yearFraction("2020-01-14","2022-01-14")
yf11423 = yearFraction("2020-01-14","2023-01-14")
yf11424 = yearFraction("2020-01-14","2024-01-14")
yf11425 = yearFraction("2020-01-14","2025-01-14")

yf114_202091 = yearFraction("2020-01-14","2020-09-01")
yf114_202131 = yearFraction("2020-01-14","2021-03-01")
yf114_202191 = yearFraction("2020-01-14","2021-09-01")
yf114_202231 = yearFraction("2020-01-14","2022-03-01")
yf114_202291 = yearFraction("2020-01-14","2022-09-01")
yf114_202331 = yearFraction("2020-01-14","2023-03-01")
yf114_202391 = yearFraction("2020-01-14","2023-09-01")
yf114_202431 = yearFraction("2020-01-14","2024-03-01")
yf114_202491 = yearFraction("2020-01-14","2024-09-01")
yf114_202531 = yearFraction("2020-01-14","2025-03-01")

y11421 = y114_202091+((y114_202131-y114_202091)/(yf114_202131-yf114_202091))*(yf11421-yf114_202091)
y11422 = y114_202191+((y114_202231-y114_202191)/(yf114_202231-yf114_202191))*(yf11422-yf114_202191)
y11423 = y114_202291+((y114_202331-y114_202291)/(yf114_202331-yf114_202291))*(yf11423-yf114_202291)
y11424 = y114_202391+((y114_202431-y114_202391)/(yf114_202431-yf114_202391))*(yf11424-yf114_202391)
y11425 = y114_202491+((y114_202531-y114_202491)/(yf114_202531-yf114_202491))*(yf11425-yf114_202491)

#---------------------------------------------------------------------
# 1/15
yf11521 = yearFraction("2020-01-15","2021-01-15")
yf11522 = yearFraction("2020-01-15","2022-01-15")
yf11523 = yearFraction("2020-01-15","2023-01-15")
yf11524 = yearFraction("2020-01-15","2024-01-15")
yf11525 = yearFraction("2020-01-15","2025-01-15")

yf115_202091 = yearFraction("2020-01-15","2020-09-01")
yf115_202131 = yearFraction("2020-01-15","2021-03-01")
yf115_202191 = yearFraction("2020-01-15","2021-09-01")
yf115_202231 = yearFraction("2020-01-15","2022-03-01")
yf115_202291 = yearFraction("2020-01-15","2022-09-01")
yf115_202331 = yearFraction("2020-01-15","2023-03-01")
yf115_202391 = yearFraction("2020-01-15","2023-09-01")
yf115_202431 = yearFraction("2020-01-15","2024-03-01")
yf115_202491 = yearFraction("2020-01-15","2024-09-01")
yf115_202531 = yearFraction("2020-01-15","2025-03-01")

y11521 = y115_202091+((y115_202131-y115_202091)/(yf115_202131-yf115_202091))*(yf11521-yf115_202091)
y11522 = y115_202191+((y115_202231-y115_202191)/(yf115_202231-yf115_202191))*(yf11522-yf115_202191)
y11523 = y115_202291+((y115_202331-y115_202291)/(yf115_202331-yf115_202291))*(yf11523-yf115_202291)
y11524 = y115_202391+((y115_202431-y115_202391)/(yf115_202431-yf115_202391))*(yf11524-yf115_202391)
y11525 = y115_202491+((y115_202531-y115_202491)/(yf115_202531-yf115_202491))*(yf11525-yf115_202491)


#2021
x2112 = log(y1321/y1221)
x2113 = log(y1621/y1321)
x2116 = log(y1721/y1621)
x2117 = log(y1821/y1721)
x2118 = log(y1921/y1821)
x2119 = log(y11021/y1921)
x21110 = log(y11321/y11021)
x21113 = log(y11421/y11321)
x21114 = log(y11521/y11421)

x2112 
x2113 
x2116 
x2117
x2118 
x2119
x21110
x21113
x21114 

#2022
x2212 = log(y1322/y1222)
x2213 = log(y1622/y1322)
x2216 = log(y1722/y1622)
x2217 = log(y1822/y1722)
x2218 = log(y1922/y1822)
x2219 = log(y11022/y1922)
x22110 = log(y11322/y11022)
x22113 = log(y11422/y11322)
x22114 = log(y11522/y11422)

x2212 
x2213 
x2216 
x2217
x2218 
x2219
x22110
x22113
x22114 

#2023
x2312 = log(y1323/y1223)
x2313 = log(y1623/y1323)
x2316 = log(y1723/y1623)
x2317 = log(y1823/y1723)
x2318 = log(y1923/y1823)
x2319 = log(y11023/y1923)
x23110 = log(y11323/y11023)
x23113 = log(y11423/y11323)
x23114 = log(y11523/y11423)

x2312 
x2313 
x2316 
x2317
x2318 
x2319
x23110
x23113
x23114 

#2024
x2412 = log(y1324/y1224)
x2413 = log(y1624/y1324)
x2416 = log(y1724/y1624)
x2417 = log(y1824/y1724)
x2418 = log(y1924/y1824)
x2419 = log(y11024/y1924)
x24110 = log(y11324/y11024)
x24113 = log(y11424/y11324)
x24114 = log(y11524/y11424)

x2412 
x2413 
x2416 
x2417
x2418 
x2419
x24110
x24113
x24114 

#2025
x2512 = log(y1325/y1225)
x2513 = log(y1625/y1325)
x2516 = log(y1725/y1625)
x2517 = log(y1825/y1725)
x2518 = log(y1925/y1825)
x2519 = log(y11025/y1925)
x25110 = log(y11325/y11025)
x25113 = log(y11425/y11325)
x25114 = log(y11525/y11425)

x2512 
x2513 
x2516 
x2517
x2518 
x2519
x25110
x25113
x25114 

c21 = c(x2112,x2113,x2116,x2117,x2118,x2119,x21110,x21113,x21114)
c22 = c(x2212,x2213,x2216,x2217,x2218,x2219,x22110,x22113,x22114)
c23 = c(x2312,x2313,x2316,x2317,x2318,x2319,x23110,x23113,x23114)
c24 = c(x2412,x2413,x2416,x2417,x2418,x2419,x24110,x24113,x24114)
c25 = c(x2512,x2513,x2516,x2517,x2518,x2519,x25110,x25113,x25114)

c21_bar = c(mean(c21),mean(c21),mean(c21),mean(c21),mean(c21),mean(c21),mean(c21),mean(c21),mean(c21))
c22_bar = c(mean(c22),mean(c22),mean(c22),mean(c22),mean(c22),mean(c22),mean(c22),mean(c22),mean(c22))
c23_bar = c(mean(c23),mean(c23),mean(c23),mean(c23),mean(c23),mean(c23),mean(c23),mean(c23),mean(c23))
c24_bar = c(mean(c24),mean(c24),mean(c24),mean(c24),mean(c24),mean(c24),mean(c24),mean(c24),mean(c24))
c25_bar = c(mean(c25),mean(c25),mean(c25),mean(c25),mean(c25),mean(c25),mean(c25),mean(c25),mean(c25))


X = cbind(c21,c22,c23,c24,c25)
X_bar = cbind(c21_bar,c22_bar,c23_bar,c24_bar,c25_bar)

yield_cov_matrix = (t(X-X_bar))%*%(X-X_bar)/8 

yield_cov_matrix 

ev = eigen(yield_cov_matrix)

ev

ev$values[1]/sum(ev$values)
